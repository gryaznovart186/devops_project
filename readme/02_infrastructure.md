# Создание инфраструктуры
Сначала нужно создать облачное хранилище для state-файлов — отдельно от основной инфраструктуры, чтобы не было конфликтов при её удалении и пересоздании:
1. Перейти в папку **terraform/storage/**.
2. Переименовать файл **terraform.tfvars.example** в **terraform.tfvars**, внутри него указать название проекта.
3. Выполнить команду `terraform init`, после чего — `terraform apply`. Дождаться создания облачного хранилища.

Теперь можно создать саму инфрастуктуру. Для этого нужно перейти в папку **terraform/**, повторить пункты 2–3 и дождаться создания инфраструктуры (выполнение — около 1,5 минуты).

## Результат
В GCP создана сеть **devops-project-network**, в ней находятся четыре виртуальные машины со статическими IP-адресами и правила файервола для доступа к ним. SSH-ключи уже добавлены из метаданных проекта.

Отдельно создано хранилище с названием **devops-project-storage-bucket**, в котором содержатся state-файлы инфраструктуры.

## Как проверить
Все созданные ресурсы должны появиться в консоли управления GCP.

## Замечание
Если хранилище **devops-project-storage-bucket** уже существует, а state-файла для него в каталоге **terraform/storage/** нет (например, хранилище было создано кем-то другим), то его необходимо импортировать, выполнив в каталоге **terraform/storage/** команду:
```bash
$ terraform import google_storage_bucket.backend-store devops-project-storage-bucket
```

<br/>

Следующий шаг: [Подготовка инфраструктуры](03_prepare.md)

Предыдущий шаг: [Предварительные шаги](01_prerequisites.md)

<br/>

[Вернуться на главную страницу](../README.md)
