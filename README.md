# Итоговый проект по курсу «DevOps практики и инструменты»
Authors: rustsh & gryaznovart186

## Оглавление
- [О проекте](#о-проекте)
    - [Используемые инструменты](#используемые-инструменты)
    - [Результат выполнения проекта](#результат-выполнения-проекта)
    - [Репозитории приложения](#репозитории-приложения)
- [Структура репозитория](#структура-репозитория)
- [Запуск проекта](#запуск-проекта)
- [Удаление проекта](#удаление-проекта)
- [История изменений](#история-изменений)

## О проекте
Данный проект позволяет развернуть приложение Crawler в облачной инфраструктуре.

### Используемые инструменты
1. Создание инфраструктуры — [Terraform](https://www.terraform.io/).
2. Конфигурирование инфраструктуры — [Ansible](https://www.ansible.com/).
3. Процесс CI/CD — [Gitlab](https://about.gitlab.com/).
4. Процесс сбора обратной связи:
    - сбор метрик — [Prometheus](https://prometheus.io/);
    - визуализация — [Grafana](https://grafana.com/);
    - алертинг — [Alertmanager](https://prometheus.io/docs/alerting/alertmanager/) + [Slack](https://slack.com/intl/en-ru/).

### Результат выполнения проекта
1. Созданная в Google Cloud Platform инфраструктура:
    - хранилище state-файлов;
    - виртуальные машины для тестового и рабочего окружений, сервера CI/CD и системы сбора обратной связи с внешними статическими IP-адресами;
    - отдельная сеть, в которой расположены виртуальные машины, и правила файервола для доступа к ним.
2. Развёрнутые на этой инфраструктуре системы и сервисы:
    - docker-контейнеры с приложением, его веб-интерфейсом, базой MongoDB и брокером очередей сообщений RabbitMQ в отдельной docker-сети на тестовом и рабочем окружениях;
    - система для CI/CD;
    - система сбора обратной связи.
3. Настроенный процесс CI/CD:
    - Dockerfiles для создания docker-образов приложения и веб-интерфейса;
    - сервер Gitlab с проектами, включающими репозитории компонентов приложения, и раннером;
    - конвейер, который запускается при внесении изменений в удалённые репозитории компонентов приложения и включает в себя:
        - сборку docker-образа приложения;
        - тестирование работы приложения;
        - публикацию контейнера с приложением на тестовое окружение;
        - ручной запуск публикации контейнера с приложением на рабочее окружение из ветки **master** при успешном выполнении всех предыдущих шагов.
4. Настроенный процесс сбора обратной связи:
    - сбор метрик при помощи Prometheus;
    - визуализация при помощи Grafana;
    - алертинг и отправка оповещений в канал Slack.

### Репозитории приложения
- [crawler](https://github.com/rustsh/search_engine_crawler)
- [ui](https://github.com/rustsh/search_engine_ui)

## Структура репозитория
- [terraform](terraform) — папка со скриптами Terraform ([подробное описание](terraform/README.md));
- [ansible](ansible) — папка с плейбуками и ролями Ansible ([подробное описание](ansible/README.md));
- [grafana-dashboards](grafana-dashboards) — папка с дашбордами Grafana в виде JSON-файлов;
- [app-files](app-files) — папка с файлами для создания контейнеров приложения и запуска конвейера CI/CD в Gitlab ([описание файлов и конвейера](app-files/README.md));
- [readme](readme) — папка с описанием шагов запуска проекта.

## Запуск проекта
- [Требования](readme/00_requirements.md)
- [Предварительные шаги](readme/01_prerequisites.md)
- [Создание инфраструктуры](readme/02_infrastructure.md)
- [Подготовка инфраструктуры](readme/03_prepare.md)
- [Деплой приложения](readme/04_deploy.md)

## Удаление проекта
Для того, чтобы удалить всю созданную инфраструктуру, нужно перейти в папку **terraform/** и выполнить команду `terraform destroy`. Дождавшись завершения её работы, перейти в папку **terraform/storage/** и ещё раз выполнить команду `terraform destroy` для удаления облачного хранилища.

## История изменений
[CHANGELOG.md](CHANGELOG.md)
